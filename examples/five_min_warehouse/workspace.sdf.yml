workspace:
  edition: "1.2"
  description: >
    The dau workspace explores workflows, schedules, grains and date partitioned data

    It defines the following tables:

    (1.) events: an external table that lands every 6 hours.

    (2.) hau: 6 hourly aggregate of 6 hourly user events.

    (3.) dau: daily aggregate of 6 hourly aggregate user events.

    (4.) lau_slow: daily aggregate of lifetime user event via computation from the beginning of time.

    (5.) lau_fast: daily aggregate of lifetime user event via tabulation from the beginning of time.

    (6.) lau_top5: daily aggregate of top 2 of fast lifetime user event.

    Type sdf compile to see the tables schemas, 

    Type sdf build --from 2022-01-02 --to 2022-01-03 to see one day of values

    Type sdf build --from 2022-01-02 --to 2022-01-03 again to see the .sdfcache in action 

    Type 'sdf auth login' and 'sdf deploy' to deploy the workspace to the sdf console

    To follow along: https://docs.sdf.com/guide/schedules
  name: five_min_warehouse
  includes:
    - path: src/
    - path: additional_tables/local/events.sql
    - path: additional_tables/local/adhoc.sql
    - path: events/
      type: resource
    # - path: additional_tables/remote/events.sql # try running against remote events data

  vars:
    dt: 20220102
    hr: 00
    time: 10:05
---
table:
  name: events
  schedule: "*/5 * * * *"
  partitioned-by:
    - name: "dt"
      format: "%Y-%m-%d"
    - name: "time"
      format: "%H:%M"
---
table:
  name: minau
  schedule: "*/5 * * * *"
  partitioned-by:
    - name: "dt"
      format: "%Y-%m-%d"
    - name: "time"
      format: "%H:%M"
---
table:
  name: hau
  schedule: "0 */6 * * *"
  partitioned-by:
    - name: "dt"
      format: "%Y-%m-%d"
    - name: "hr"
      format: "%H"
---
table:
  name: dau
  schedule: "0 0 * * *"
  partitioned-by:
    - name: "dt"
      format: "%Y-%m-%d"
---
table:
  name: lau_slow
  schedule: "0 0 * * *"
  partitioned-by:
    - name: "dt"
      format: "%Y-%m-%d"
---
table:
  name: lau_fast
  schedule: "0 0 * * *"
  partitioned-by:
    - name: "dt"
      format: "%Y-%m-%d"
---
table:
  name: lau_top_fast
  schedule: "0 0 * * *"
  partitioned-by:
    - name: "dt"
      format: "%Y-%m-%d"
